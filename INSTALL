INSTALL

The simplest way to install utagboot is to use a micro-SD card as that does not
require rooting the phone or installing custom software to it such as e2fsprogs
for mkfs.ext4. Your should also make sure that the device is updated to the
stock firmware release (VRZ_XT894_9.8.2O-72_VZW-18-8_CFC).

The example below assumes install to the first partition on a micro-SD card
using a micro-SD card reader on a PC:

1. Partition and format a micro-SD card

See the generic Linux documentation on doing this. You probably want to use a
reasonably fast micro-SD card.

2. Install usable ARM Linux root file system

See the distro specific instructions for this. You can typically get a minimal
rootfs or use a distro specific tool to create it.

Note that the distro needs to have a recent kexec binary from kexec-tools
installed.

3. Copy utagboot files to the micro-SD card

Assuming the micro-SD card is mounted to /mnt, you can install utagboot files
to the /boot directory on the micro-SD card with:

$ sudo tar zxf utagboot-bin-2017-09-26.tar.gz -C /mnt/boot

4. Install kernel to the micro-SD card

See Linux kernel documentation for building the kernel and dtb. Note that
some patches are still pending and not yet merged to the mainline kernel such
as LCD support.

5. Edit utagboot.conf

Edit /boot/utagboot/utagboot.conf on the micro-SD card depending on the location
of your kernel and dtb:

cmdline="console=tty0 console=ttyS2,115200 fbcon=rotate:1 \
debug earlyprintk earlycon root=/dev/mmcb0p1"
dtb="/boot/omap4-droid4-xt894.dtb"
vmlinuz="/boot/vmlinuz"
initramfs="/boot/initramfs"

6. Configure utagboot for the selected rootfs

To allow updating utags with fastboot, you need to install the permissive
mbm bootloader from VRZ_XT894_9.8.2O-72_VZW-18-8_CFC stock firmware. You can
do this after connecting the device over USB and starting it in fastboot mode
by holding down Volume-Down button while powerin the device on. Then type:

$ fastboot flash mbm allow-mbmloader-flashing-mbm.bin

After that you can modify the utags partition with fastboot. Just be careful
with the eMMC partitions as many of them have checksums and overwriting the
wrong partitions can brick the device.

To install utags.bin to the device utags partition to boot to partition
mmcblk0p1, type;

$ fastboot flash utags utags-mmcblk0p1.bin

Where utags-mmcblk0p1.bin can be found generated either on the device micro-SD
card /boot/directory, or in the output/utagboot directory of the source code.

And once you're done, you probably want to do install the stock mbm with:

$ fastboot flash mbm mbm.bin

And then you should be able to reboot to the mmcblk0p1 partition.


UNINSTALL

To uninstall utagboot, connect the device in fastboot mode over USB and type:

$ fastboot erase utags

This will erase the utags partition and allow booting the stock Android or
SafeStrap if that is installed.
